</script>

</div>

<button type="button" onclick="submitExam()">Submit Exam</button>

<h3>Item-Level Performance Heatmap (Q1–Q100)</h3>
<div id="heatmap"></div>

<!-- ================= SCRIPT ================= -->

<script>
const rationales = {
  1: "Fail-Fast: Abnormal vital signs ignored.",
  2: "Tie-breaker: Time priority missed.",
  3: "Medication safety logic violated.",
  4: "Delegation trap: RN action required.",
  5: "ABC breach: Airway not prioritized.",

  41: "Calculation error → unsafe IV rate.",
  42: "Fluid overload risk missed.",
  61: "Ethical delay causes patient harm.",
  81: "Tie-breaker: vital trend beats symptoms."
};

function submitExam() {
  const heatmap = document.getElementById("heatmap");
  heatmap.innerHTML = "";

  for (let i = 1; i <= 100; i++) {
    const answers = document.getElementsByName("q" + i);
    let status = "unanswered";

    for (let a of answers) {
      if (a.checked) {
        status = (a.value === "1") ? "correct" : "wrong";
      }
    }

    const cell = document.createElement("div");
    cell.className = "heat " + status;
    cell.innerText = "Q" + i;

    const tip =
      rationales[i]
        ? rationales[i]
        : "No mapped rationale.\nTrainer review required.";

    cell.setAttribute(
      "data-tip",
      "Status: " + status.toUpperCase() + "\n" + tip
    );

    heatmap.appendChild(cell);
  }
}
</script>

</body>
</html>
